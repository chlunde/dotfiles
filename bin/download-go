#!/bin/bash
v=1.20
hash=5a9ebcc65c1cce56e0d2dc616aff4c4cedcfbda8cc6f0288cc08cda3b18dcbf1

if [[ "$(go version 2> /dev/null)" == "go version go$v "* ]]
then
    echo "Already updated"
    exit 0
fi

mkdir -p ~/Downloads/
declare -r binary=~/Downloads/go$v.linux-amd64.tar.gz
curl -o "$binary" https://storage.googleapis.com/golang/go$v.linux-amd64.tar.gz

found="$(sha256sum $binary | cut -d ' ' -f1)"

if [[ "$found" != "$hash" ]]
then
	echo "Checksum mismatch: ${found}"
	exit 1
fi

mkdir -p ~/opt
rm -Rf ~/opt/go
tar -C ~/opt -xzf $binary
